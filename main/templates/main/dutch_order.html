{% extends "base.html" %}
{% load crispy_forms_tags %}


<script>
{% block jquery %}
$('.time-input').timepicker({
    'timeFormat': 'HH:mm',
    'minTime': '09:00',
    'maxTime': '21:00'
 });
$('.date-input').datepicker({
    'format': 'yyyy-mm-dd',
    'startDate': "+1d",
    'minDate':"dateToday",
    // 'minDate': moment().add('d',1).toDate(),
    'autoclose': true
});
// function numberWithCommas(x) {
//   return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
// };
$('#id_quantity').change(function(){
    var qty = $("#id_quantity").val()
    var total = $("#total").val()
    var data = {
        qty: qty,
        total: total
    }
    console.log(data);
    $.ajax({
        type: "GET", //"POST"
        url: "{% url 'dutch_order' %}",
        data: data,
        success: function(data){
            $("#total").text(data.total);
        },
        error: function(response, error){
			console.log(response);
				// console.log(error)
		}
    })
});





// function mysetdefault(clickID, val){
//     function setdefault(){
//         var defaultval = val;
//         $(clickID).value = defaultval;
//         $(clickID).addClass("text-label");
//
//         $(clickID).focus(function(){
//             if($(clickID).value == defaultval){
//                 $(clickID).value = '';
//                 $(clickID).removeClass('text-label');
//             }
//         });
//         $(clickID).blur(function(){
//             if($(clickID).value == ''){
//                 $(clickID).value = defaultval;
//                 $(clickID).addClass("text-label");
//             }
//         });
//     };
//     $('#id_phone_regex').each(function(){setdefault();});
// }



$('#id_phone_regex').each(function(){
    var defaultval = "010-1234-5678";
    this.value = defaultval;
    $(this).addClass("text-label");


    $(this).focus(function(){
        if(this.value == defaultval){
            this.value = '';
            $(this).removeClass('text-label');
        }
    });
    $(this).blur(function(){
        if(this.value == ''){
            this.value = defaultval;
            $(this).addClass("text-label");
        }
    });
});

$('#id_email').each(function(){
    var defaultval = "someone@example.com";
    this.value = defaultval;
    $(this).addClass("text-label");


    $(this).focus(function(){
        if(this.value == defaultval){
            this.value = '';
            $(this).removeClass('text-label');
        }
    });
    $(this).blur(function(){
        if(this.value == ''){
            this.value = defaultval;
            $(this).addClass("text-label");
        }
    });
});

$(function() {
    $("#reserve").click(function(){
        if($("#id_phone_regex").val() == "010-1234-5678"){
            $("#id_phone_regex").val("");
        }
        if($("#id_email").val() == "someone@example.com"){
            $("#id_email").val("");
        }
    });
});



{% endblock %}
</script>


{% block content %}
<div class='row' style="margin-bottom: 30px">
    <h1 class="text-center">Dutch Coffee 예약</h1>
    <hr/>
    <br/>
    <div class='col-sm-8'>
        <img class='img-responsive' style="height:600px"src="{{ image.image.url }}" />
    </div>
    <div class='col-sm-4'>
        <h3 class='text-center'>매일 새로 만드는 DutchCoffee</h3>
        <h4 class='text-right'>가격: ￦<span id="total" class="total">{{ total }}</span>,000</h4>
        <form method="POST" action=''>{% csrf_token %}
            {{ form | crispy }}
            <p class="text-right"><input id="reserve" class='btn' type='submit' value='예약' /></p>
        </form>
    </div>
</div>
{% endblock %}
